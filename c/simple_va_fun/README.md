# C语言中的可变参数函数  
C语言编程中有时会遇到一些参数可变的函数，例如printf()函数，其函数原型为：  
` int printf(const char* format, ...); `    
它除了有一个参数format固定以外，后面跟的参数的个数和类型是可变的（用三个点“...”做参数占位符），实际调用时可以有以下形式：  
```  
printf("%d", i);  
printf("%s", s);  
printf("the number is %d, string is: %s", i, s);  
```  
一个简单可变参数的C函数：`simple_va_fun(int start, ...);`  
简单解释一下代码。从这个函数的实现可以看到，我们可以使用可变参数应该有以下步骤：  
1.由于在程序中将用到以下这些宏：  
```  
void va_start(va_list arg_ptr, prev_param);
type va_arg(va_list arg_ptr, type);  
void va_end(va_list arg_ptr);  
```  
va在这里是variable-argument（可变参数）的意思。  
这些宏定义在stdarg.h中，所以用到的可变参数的程序应该包含这个头文件。  
2.函数里首先定义一个va_list型的变量，这里是arg_ptr，这个变量是存储参数地址的指针。因为得到参数的地址之后，再结合参数的类型，才能得到参数的值。  
3.然后用va_start宏初始化arg_ptr，这个宏的第二个参数是可变参数列表的前一个参数，即最后一个固定参数。  
4.然后依次用va_arg宏使arg_ptr返回可变参数的地址，得到这个地址之后，结合参数的类型，就可以得到参数的值。  
5.设定结束条件，这里的条件就是判断参数值是否为-1.注意被调的函数在调用时是不知道可变参数的正确数目的，程序员必须自己在代码中知名结束条件。
至于为什么它不会知道参数的数目，在看完这几个宏的内部实现机制后，自然就会明白。
